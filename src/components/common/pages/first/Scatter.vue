<template>
    <div>
        <p>不同培养类型学员两学年公共基础课成绩分布总览</p>
        <div id="myChart" style="height:100%;width:100%;align-items: center;" />
    </div>
</template>
<script>
import * as echarts from 'echarts'
export default {
    data() {
        return {
            //待传参，考虑性能，可以传部分参数
            L1Data: [
                [86.3, 95.9], [58.2, 52.9], [53.1, 51.5], [95.2, 92.9], [73.0, 71.2],
                [58.1, 62.7], [96.6, 89.1], [62.5, 68.2], [79.8, 89.7], [50.9, 60.8],
                [70.0, 70.8], [93.6, 100.0], [51.1, 51.2], [52.3, 61.0], [72.0, 68.2],
                [86.0, 95.6], [79.2, 89.0], [97.7, 100.0], [50.5, 50.0], [69.9, 69.6],
                [90.4, 99.0], [51.9, 50.0], [70.8, 65.3], [69.2, 77.6], [69.9, 64.0],
                [87.5, 92.9], [75.1, 68.7], [79.9, 83.1], [63.2, 69.0], [50.1, 59.7],
                [55.3, 57.7], [92.1, 99.0], [79.0, 76.9], [64.6, 55.8], [75.9, 81.0],
                [68.8, 61.4], [88.6, 94.3], [80.4, 71.3], [75.6, 67.3], [98.9, 89.6],
                [87.6, 95.7], [90.3, 81.5], [93.3, 93.7], [79.8, 84.4], [92.4, 98.7],
                [78.3, 74.6], [84.4, 93.6], [97.3, 95.5], [96.8, 91.4], [57.3, 53.2],
                [86.5, 90.2], [52.3, 61.5], [54.3, 57.7], [91.7, 91.6], [68.4, 77.0],
                [62.0, 67.4], [83.2, 74.7], [66.4, 59.6], [84.8, 76.8], [50.2, 53.3],
                [65.4, 73.4], [95.1, 100.0], [81.6, 87.7], [91.8, 86.1], [68.7, 72.4],
                [57.0, 55.9], [69.5, 63.1], [54.7, 58.5], [95.7, 94.0], [96.5, 92.4],
                [52.0, 53.4], [99.3, 95.0], [51.1, 50.0], [66.6, 61.7], [81.3, 87.5],
                [76.3, 75.1], [57.0, 57.0], [70.9, 70.1], [63.2, 69.6], [68.1, 62.2],
                [70.0, 79.5], [83.8, 82.6], [75.7, 85.0], [87.0, 82.0], [99.2, 100.0],
                [52.9, 50.0], [71.9, 67.9], [84.0, 78.5], [89.9, 83.5], [85.4, 87.8],
                [77.7, 74.0], [98.4, 100.0], [61.8, 55.4], [76.0, 81.3], [100.0, 99.1],
                [98.4, 91.8], [81.9, 82.7], [58.1, 52.6]],
            L2Data: [
                [96.6, 95.4], [56.6, 61.5], [78.3, 76.3], [88.1, 89.0], [57.3, 51.2],
                [60.9, 65.8], [55.0, 58.0], [90.7, 100.0], [94.4, 93.4], [96.2, 100.0],
                [75.2, 75.1], [81.7, 83.8], [50.9, 50.5], [71.5, 71.7], [67.2, 71.6],
                [94.5, 90.9], [90.3, 90.4], [85.1, 78.7], [84.2, 87.3], [64.5, 61.5],
                [90.8, 87.0], [82.3, 81.4], [94.6, 91.9], [67.8, 60.3], [76.9, 73.8],
                [66.6, 72.2], [64.0, 67.1], [85.6, 91.3], [89.1, 97.7], [66.0, 66.2],
                [73.2, 63.7], [61.7, 67.4], [93.8, 98.2], [58.8, 67.6], [54.7, 50.0],
                [71.2, 75.5], [87.3, 92.4], [95.5, 97.6], [64.5, 63.5], [62.7, 63.1],
                [69.5, 71.2], [88.5, 89.3], [55.7, 50.0], [78.7, 84.3], [99.2, 100.0],
                [78.1, 73.4], [84.0, 74.9], [65.7, 75.1], [94.9, 92.5], [75.7, 80.7],
                [73.6, 82.8], [86.8, 78.2], [94.5, 100.0], [76.0, 70.7], [67.6, 65.8],
                [57.0, 64.6], [62.0, 54.0], [86.0, 84.5], [80.4, 71.4], [58.6, 50.4],
                [83.1, 90.1], [86.1, 88.1], [64.3, 70.3], [50.6, 50.0], [85.1, 91.1],
                [90.4, 85.2], [86.3, 79.6], [55.4, 58.4], [79.2, 70.6], [81.6, 82.5],
                [59.1, 57.7], [83.6, 87.1], [79.7, 83.2], [93.1, 84.5], [78.1, 76.8],
                [92.3, 94.0], [79.0, 80.2], [95.2, 88.1], [83.3, 87.4], [98.5, 100.0],
                [68.4, 59.2], [60.3, 58.5], [72.1, 79.3], [59.8, 62.0], [58.9, 51.7],
                [56.7, 64.2], [89.8, 85.7], [94.8, 91.6], [60.5, 54.2], [74.4, 76.4],
                [82.2, 81.9], [72.7, 74.4], [77.4, 73.1], [96.1, 95.4], [84.8, 87.1],
                [86.2, 84.9], [78.9, 87.7], [67.0, 71.4], [92.6, 93]
            ],
            L3Data: [
                [95.0, 95.7], [78.8, 72.9], [53.1, 50.0], [78.1, 87.0], [85.0, 90.7],
                [76.1, 71.7], [51.4, 59.3], [74.2, 80.1], [72.9, 70.2], [59.9, 60.6],
                [80.4, 89.4], [64.6, 63.4], [99.1, 97.0], [95.9, 89.7], [78.4, 72.8],
                [69.9, 73.0], [64.7, 72.5], [64.5, 57.8], [92.3, 83.5], [53.8, 56.2],
                [92.3, 92.1], [52.2, 61.5], [64.2, 55.2], [91.6, 98.3], [96.8, 91.0],
                [85.4, 77.7], [75.8, 80.1], [64.5, 54.5], [76.0, 82.3], [60.2, 68.4],
                [70.0, 74.8], [58.4, 55.9], [60.8, 64.9], [81.4, 75.4], [83.5, 82.1],
                [88.6, 82.0], [52.7, 50.0], [68.2, 59.8], [57.0, 63.8], [53.7, 53.5],
                [80.8, 88.7], [65.6, 66.1], [91.5, 92.9], [93.3, 100.0], [86.7, 95.8],
                [83.2, 91.4], [70.6, 68.3], [61.0, 64.2], [94.9, 99.0], [52.2, 57.8],
                [91.1, 82.0], [97.5, 91.1], [62.7, 62.6], [99.2, 89.4], [73.2, 75.3],
                [86.1, 88.1], [72.2, 68.0], [93.9, 92.0], [88.0, 85.3], [91.4, 83.5],
                [51.9, 52.6], [71.7, 64.0], [52.0, 56.6], [68.6, 61.8], [92.5, 94.1],
                [76.0, 66.4], [91.7, 96.6], [64.6, 69.3], [90.7, 90.5], [96.8, 100.0],
                [77.5, 82.5], [79.1, 88.1], [75.8, 83.3], [83.5, 88.6], [60.1, 67.6],
                [63.8, 54.7], [60.2, 61.1], [66.4, 58.4], [91.0, 85.8], [54.4, 51.9],
                [63.2, 58.7], [78.2, 86.6], [79.6, 84.9], [81.2, 76.9], [95.4, 89.3],
                [71.9, 74.9], [75.9, 77.8], [87.5, 83.4], [63.7, 58.9], [93.4, 98.4],
                [92.3, 91.6], [69.8, 69.2], [76.0, 75.8], [98.6, 90.5], [89.9, 97.2],
                [72.7, 80.7], [57.4, 62.9], [88.9, 80.4], [74.1, 77]
            ]
        }
    },
    mounted() {
        this.drawLine()
    },
    methods: {
        drawLine() {
            // 基于准备好的dom，初始化echarts实例
            var chartDom = document.getElementById('myChart');
            var myChart = echarts.init(chartDom);
            var option;

            function calculateAverage(data, dim) {
                let total = 0;
                for (var i = 0; i < data.length; i++) {
                    total += data[i][dim];
                }
                return (total /= data.length);
            }
            const scatterOption = (option = {
                xAxis: {
                    scale: true
                },
                yAxis: {
                    scale: true
                },
                series: [
                    {
                        type: 'scatter',
                        id: 'L1',
                        dataGroupId: 'L1',
                        universalTransition: {
                            enabled: true,
                            delay: function (idx, count) {
                                return Math.random() * 400;
                            }
                        },
                        data: this.L1Data
                    },
                    {
                        type: 'scatter',
                        id: 'L2',
                        dataGroupId: 'L2',
                        universalTransition: {
                            enabled: true,
                            delay: function (idx, count) {
                                return Math.random() * 400;
                            }
                        },
                        data: this.maleDeta
                    },
                    {
                        type: 'scatter',
                        id: 'L3',
                        dataGroupId: 'L3',
                        universalTransition: {
                            enabled: true,
                            delay: function (idx, count) {
                                return Math.random() * 400;
                            }
                        },
                        data: this.maleDeta
                    }
                ]
            });
            const barOption = {
                xAxis: {
                    type: 'category',
                    data: ['指挥类', '融合类', '非指挥类']
                },
                yAxis: {},
                series: [
                    {
                        type: 'bar',
                        id: 'total',
                        data: [
                            {
                                value: calculateAverage(this.L1Data, 0),
                                groupId: 'L1'
                            },
                            {
                                value: calculateAverage(this.L2Data, 0),
                                groupId: 'L2'
                            },
                            {
                                value: calculateAverage(this.L3Data, 0),
                                groupId: 'L3'
                            }
                        ],
                        universalTransition: {
                            enabled: true,
                            seriesKey: ['L1', 'L2', 'L3'],
                            delay: function (idx, count) {
                                return Math.random() * 400;
                            }
                        }
                    }
                ]
            };
            let currentOption = scatterOption;
            setInterval(function () {
                currentOption = currentOption === scatterOption ? barOption : scatterOption;
                myChart.setOption(currentOption, true);
            }, 5000);

            option && myChart.setOption(option);
        }
    }
}
</script>